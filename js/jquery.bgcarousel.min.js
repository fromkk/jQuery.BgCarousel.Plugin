/*!
 * jQuery BgCarousel Plugin
 * http://fromkk.me/
 * 
 * Copyright 2014, FromKK
 * Released under the MIT license
 */
"use strict";if(!String.prototype.px2int){String.prototype.px2int=function(){return parseInt(this.replace("px",""))}}var BgCarousel=function(){var e=null;var t=function(t,n,r){e=this;if(typeof t==="undefined"){t={}}this.jq=r;this.element=n;this.option=this.jq.extend({left:"#left-button",right:"#right-button",children:"li",contents:"img,video",duration:250,interval:3e3,direction:"left",easing:"linear",timer:true,keyboard:true},t);this.animating=false;this.initialized=true;var i=0;var s=this.jq(this.element).width();this.jq(this.element).find(this.option.children).each(function(){e.jq(this).css("left",s*i+"px").data("sort",i);i++});this.jq(window).on("resize",function(){e.check_window_size.call(e)});this.jq(this.option.left).on("click",function(){e.left.call(e)});this.jq(this.option.right).on("click",function(){e.right.call(e)});this.check_contents_size.call(this);this.check_timer.call(this);if(this.option.keyboard){$(window).on("keyup",function(t){if(37===t.keyCode){e.left.call(e)}else if(39===t.keyCode){e.right.call(e)}return true})}};t.prototype.reset_timer=function(){if(null!==this.timer){clearInterval(this.timer);this.timer=null}};t.prototype.check_timer=function(){this.timer=null;if(this.option.timer){this.timer=setTimeout(function(){if("left"===e.option.direction){e.left.call(e)}else if("right"===e.option.direction){e.right.call(e)}},this.option.interval)}};t.prototype.check_contents_size=function(){var t=this.element.width()/this.element.height();this.jq(this.element).find(this.option.children).find(this.option.contents).each(function(){var n=e.jq(this).width()/e.jq(this).height();if(t<n){e.jq(this).css("height","100%").css("width","auto")}else{e.jq(this).css("width","100%").css("height","auto")}})};t.prototype.check_window_size=function(){var t=this.jq(this.element).width();this.jq(this.element).find(this.option.children).each(function(){e.jq(this).css("left",t*e.jq(this).data("sort")+"px")});this.check_contents_size.call(this)};t.prototype.min=function(){var t=Number.MAX_VALUE,n=null;this.jq(this.element).find(this.option.children).each(function(){if(t>=e.jq(this).css("left").px2int()){t=e.jq(this).css("left").px2int();n=this}});return n};t.prototype.max=function(){var t=Number.MIN_VALUE,n=null;this.jq(this.element).find(this.option.children).each(function(){if(t<=e.jq(this).css("left").px2int()){t=e.jq(this).css("left").px2int();n=this}});return n};t.prototype.left=function(){if(this.animating){return}this.reset_timer.call(this);this.animating=true;var t=this.jq(this.element).width();var n=this.max.call(this);var r=this.min.call(this);var i=0;this.jq(this.element).find(this.option.children).each(function(){e.jq(this).animate({left:e.jq(this).css("left").px2int()-t+"px"},e.option.duration,e.option.easing,function(){i++;if(i===e.jq(e.element).find(e.option.children).length){e.jq(r).css("left",e.jq(n).css("left").px2int()+t+"px");e.animating=false;e.check_contents_size.call(e);e.check_sort.call(e);e.check_timer.call(e)}})})};t.prototype.right=function(){if(this.animating){return}this.reset_timer.call(this);this.animating=true;var t=this.jq(this.element).width();var n=this.max.call(this);var r=this.min.call(this);var i=0;this.jq(n).css("left",this.jq(r).css("left").px2int()-t+"px");this.jq(this.element).find(this.option.children).each(function(){e.jq(this).animate({left:e.jq(this).css("left").px2int()+t+"px"},e.option.duration,e.option.easing,function(){i++;if(i===e.jq(e.element).find(e.option.children).length){e.animating=false;e.check_contents_size.call(e);e.check_sort.call(e);e.check_timer.call(e)}})})};t.prototype.check_sort=function(){var t=this.jq(this.element).width();this.jq(this.element).find(this.option.children).each(function(){e.jq(this).data("sort",e.jq(this).css("left").px2int()/t)})};return t}();(function(e){e.fn.BgCarousel=function(t){return new BgCarousel(t,this,e)}})(jQuery)